#:kivy 1.11.1

<ArticleSubtitle>:
    text: ''
    font_size: '20dp'
    text_size: self.size
    bold: True
    halign: 'left'
    valign: 'middle'
    color: .2, .2, .2, 1
    size_hint_y: None
    height: '50dp'

<ArticleParagraph>:
    text: ''
    markup: True
    font_size: '16dp'
    text_size: self.width, None
    color: .2, .2, .2, 1
    size_hint_y: None
    height: self.texture_size[1]

<ArticleImage>:
    source: ''
    caption: ''
    orientation: 'vertical'
    size_hint_y: None
    height: self.minimum_height
    spacing: '8dp'
    AsyncImage:
        source: root.source
        size_hint: None, None
        width: self.parent.width - (2 * self.parent.padding[0])
        height: self.parent.width/self.image_ratio
        keep_ratio: True
        allow_stretch: True
    Label:
        text: root.caption
        font_size: '14dp'
        text_size: self.width, None
        size_hint_y: None
        height: self.texture_size[1]
        color: .4, .4, .4, 1
        markup: True

<ArticleAudio>:
    caption: ''
    slider_value: 0
    sound_track_length: 0
    orientation: 'vertical'
    size_hint_y: None
    height: self.minimum_height
    spacing: '8dp'
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: '80dp'
        padding: '4dp'
        canvas:
            Color:
                rgba: .2, .2, .2, 1
            Line:
                width: 1
                rectangle: self.x, self.y, self.width, self.height
        ToggleButton:
            id: toggle_button
            size_hint_x: None
            width: '80dp'
            background_normal: ''
            background_down: ''
            on_state: root.toggle_audio_play(self.state)
            Image:
                source: 'assets/img/play-darkgray.png' if self.parent.state == 'normal' else 'assets/img/pause-darkgray.png'
                pos: self.parent.pos
                size: self.parent.size
        BoxLayout:
            orientation: 'vertical'
            padding: '8dp'
            Slider:
                orientation: 'horizontal'
                min: 0
                max: 100
                step: 1
                value: root.slider_value
                value_track: True
                value_track_color: 0, .6, .7, 1
                on_value: root.on_slider_value_change(self.value)
            Label:
                text: '{:>02}:{:02} / {:>02}:{:02}'.format(round((root.slider_value / 100) * (root.sound_track_length // 60)), round((root.slider_value / 100) * (root.sound_track_length % 60)), round(root.sound_track_length // 60), round(root.sound_track_length % 60))
                text_size: self.size
                halign: 'right'
                color: .2, .2, .2, 1
    Label:
        text: root.caption
        font_size: '14dp'
        text_size: self.width, None
        size_hint_y: None
        height: self.texture_size[1]
        color: .4, .4, .4, 1
        markup: True

<ArticleVideo>:
    video_player: video_player
    video_source: None
    cover_image_source: None
    caption: ''
    slider_value: 0
    video_track_length: 0
    orientation: 'vertical'
    size_hint_y: None
    height: self.minimum_height
    spacing: '8dp'
    BoxLayout:
        orientation: 'vertical'
        size_hint_y: None
        height: self.minimum_height
        AnchorLayout:
            id: anchor_content_center
            anchor_x: 'center'
            anchor_y: 'center'
            size_hint: None, None
            size: video_cover_image.size
            Video:
                id: video_player
                canvas:
                    Color:
                        rgba: .2, .2, .2, 1
                    Line:
                        width: 1
                        rectangle: self.x, self.y, self.width, self.height
            Image:
                id: video_cover_image
                source: root.cover_image_source
                size_hint: None, None
                width: root.width - (2 * root.padding[0])
                height: root.width / self.image_ratio
                keep_ratio: True
                allow_stretch: True
                opacity: 1 if video_player.state == 'stop' else 0
                canvas:
                    Color:
                        rgba: .2, .2, .2, 1
                    Line:
                        width: 1
                        rectangle: self.x, self.y, self.width, self.height
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: '80dp'
            padding: '4dp'
            canvas:
                Color:
                    rgba: .2, .2, .2, 1
                Line:
                    width: 1
                    rectangle: self.x, self.y, self.width, self.height
            ToggleButton:
                id: toggle_button
                size_hint_x: None
                width: '80dp'
                background_normal: ''
                background_down: ''
                on_state: root.toggle_video_play(self.state)
                Image:
                    source: 'assets/img/play-darkgray.png' if self.parent.state == 'normal' else 'assets/img/pause-darkgray.png'
                    pos: self.parent.pos
                    size: self.parent.size
            BoxLayout:
                orientation: 'vertical'
                padding: '8dp'
                Slider:
                    orientation: 'horizontal'
                    min: 0
                    max: 100
                    step: 1
                    value: root.slider_value
                    value_track: True
                    value_track_color: 0, .6, .7, 1
                    on_value: root.on_slider_value_change(self.value)
                Label:
                    text: '{:>02}:{:02} / {:>02}:{:02}'.format(round((root.slider_value / 100) * (root.video_track_length // 60)), round((root.slider_value / 100) * (root.video_track_length % 60)), round(root.video_track_length // 60), round(root.video_track_length % 60))
                    text_size: self.size
                    halign: 'right'
                    color: .2, .2, .2, 1
    Label:
        text: root.caption
        font_size: '14dp'
        text_size: self.width, None
        size_hint_y: None
        height: self.texture_size[1]
        color: .4, .4, .4, 1
        markup: True

<ArticleContent>:
    orientation: 'vertical'
    size_hint_y: None
    height: self.minimum_height
    padding: 0, '20dp'
    spacing: '20dp'
